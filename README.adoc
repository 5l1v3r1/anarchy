[source,yaml]
--------------------------------------------------------------------------------
---
apiVersion: gpte.redhat.com/v1
kind: AnarchyGovernor
metadata:
  name: reqres-in-example
spec:
  parameters: {}
  subjectEventActions:
    added: register
    #modified:
    deleted: delete
  actions:
  - name: register
    expireAfter: 30s
    api:
      url: https://reqres.in/api/register
      request:
        method: POST
      statusCodeEvents:
        200: registered
    eventHandlers:
    - event: registered
      handlers:
      - handlerType: scheduleAction
        scheduleActionParams:
          action: check
          after: 1m
      - handlerType: setStatus
        setStatusParams:
          userId: "{{ response.json.data.id }}
  - name: check
    expireAfter: 30s
    api:
      url: "https://reqres.in/api/users/{{ subject.status.userId }}"
      statusCodeEvents:
        200: okay
        404: not_found
    eventHandlers:
    - event: okay
      handlers:
      - handlerType: scheduleAction
        scheduleActionParams:
          action: check
          after: 1m
    - event: not_found
      handlers:
      - handlerType: scheduleAction
        scheduleActionParams:
          action: register
  - name: delete
    expireAfter: 30s
    api:
      url: "https://reqres.in/api/users/{{ subject.status.user_id }}"
      request:
        method: DELETE
      statusCodeEvents:
        200: okay
        404: not_found
    eventHandlers:
    - event: okay
      handlers:
      - handlerType: scheduleAction
        scheduleActionParams:
          action: check
          after: 1m
    - event: not_found
      handlers:
      - handlerType: scheduleAction
        scheduleActionParams:
          action: register
          after: 5m
--------------------------------------------------------------------------------

[source,yaml]
--------------------------------------------------------------------------------
apiVersion: gpte.redhat.com/v1
kind: AnarchySubject
metadata:
  name: reqres-in-example
spec:
  governor: reqres-in-example
  parameters:
    email: somebody@example.com
    name: somebody
    password: p4ssw0rd
--------------------------------------------------------------------------------

[source,yaml]
--------------------------------------------------------------------------------
apiVersion: gpte.redhat.com/v1
kind: AnarchyGovernor
metadata:
  name: babylon-ocp4-workshop
spec:
  # List of parameters to pass to the Babylon Tower job template along with
  # whatever parameters are in the AgnosticDeployment. Parameters in the
  # AgnosticDeployment override parameters here.
  #
  # Values may strings or dictionaries that give details on how to fetch the
  # value from a secret.
  parameters:
    cloud_provider: ec2
    aws_access_key_id:
      secret_name: opentlc_aws_creds
      secret_key: aws_access_key_id
    aws_secret_access_key:
      secret_name: opentlc_aws_creds
      secret_key: aws_access_key_id
  # Action to initiate immediately on creation
  initalAction: deploy
  # Each action should correspond to a Babylon Tower Job template name
  actions:
  - name: deploy
    api:
      url: https://...
    eventHandlers:
    - event: started
      handlers:
      - handlerType: email
        emailParams:
          to: ["requester"]
          from: noreply@opentlc.com
          subject: >-
            Your Red Hat OPENTLC ocp4-workshop
            {{ agnostic_deployment.metadata.name }} deployment has started
          body: |-
            ... jinja template ...
    - event: complete
      handlers:
      - handlerType: scheduleAction
        scheduleActionParams:
          action: destroy
          after: 6d
      - handlerType: scheduleAction
        scheduleActionParams:
          action: suspend
          after: 8h
      - handlerType: email
        emailParams:
          to: ["requester"]
          from: noreply@opentlc.com
          subject: >-
            Your Red Hat OPENTLC ocp4-workshop
            {{ agnostic_deployment.metadata.name }} has been deployed
          body: |-
            ... jinja template ...
    - event: error
      handlers:
      - handlerType: email
        emailParams:
          to:
          - requester
          ...
  - name: destroy
    api:
      url: https://...
    eventHandlers:
    - event: complete
      handlers:
      - handlerType: email
        emailParams:
          to:
          - requester
          from: noreply@opentlc.com
          subject: >-
            Your Red Hat OPENTLC ocp4-workshop
            {{ agnostic_deployment.metadata.name }} has been destroyed.
          body: |-
            ... jinja template â€¦
  - name: suspend
    api:
      url: https://...
    ...
  - name: resume
    api:
      url: https://...
    eventHandlers:
    - event: complete
      handlers:
      - handlerType: scheduleAction
        scheduleActionParams:
          action: suspend
          after: 8h
    ...
--------------------------------------------------------------------------------

[source,yaml]
--------------------------------------------------------------------------------
---
apiVersion: gpte.redhat.com/v1
kind: AnarchySubject
metadata:
  # Name is based on agnosticd config type and a random string
  name: ocp4-workshop-a4d93efa1359
  labels:
    # Label agnosticd config type for reporting
    governor: babylon-ocp4-workshop
    # GUID is not set by the template, but is labeled after a guid is set
    guid: a39f
  namespace: anarchy
spec:
  # Requester for the service... not sure about the fields here
  requester:
    name: someone-example.com
    email: someone@example.com
  governor: babylon-ocp4-workshop
  # Parameters are free-form dictionary
  parameters:
    openshift_release: "4.1"
    aws_region: us-east-1
    repo_version: "3.11"
    subdomain_base_suffix: .example.opentlc.com
status:
  # operator sets status including action schedule
  action_schedule:
    deploy:
      at: 2019-06-04T01:03:39Z
      started: true
    destroy:
      at: 2019-06-10T01:03:39Z
      started: false
  state: requested
  actions:
  - action: deploy
    at: 2019-06-04T01:03:39Z
    id: e94d8acd-1ede-420a-942a-ef35c8ee88f0
--------------------------------------------------------------------------------
